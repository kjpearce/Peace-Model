%%%%% Sustainable Peace ODE Model RHS

%%%%% Author: Kate Pearce


%%%%% From causal loop diagram in Liebovitch et al. "Modeling the Dynamics of
%%%%% Sustainable Peace" Springer 2018



%%%%% 


  function dy = peace_ddt(t,y,m,b,s)


%%% m: degree of memory for system (neg mem stronger influence than pos) 
m_neg = m.m_pos * m.gamma;

%%% b: self-reinforcement of peace factor (unknown values)
%%% s: nonzero strengths between factors 

%%%% system species
x1 = y(1);
x2 = y(2);
x3 = y(3);
x4 = y(4);
x5 = y(5);
x6 = y(6);


%
  dy = [-m.m_pos*x1 + b.b1 + c15*tanh(x5);
        -m_neg*x2 + b.b2 + c26*tanh(x6);
        -m.m_pos*x3 + b.b3 + c31*tanh(x1) + c35*tanh(x5); 
        -m_neg*x4 + b.b4 + c42*tanh(x2) + c46*tanh(x6);
        -m.m_pos*x5 + b.b5 + c51*tanh(x1) + c53*tanh(x3) + c56*tanh(x6);
        -m_neg*x6 + b.b6 + c62*tanh(x2) + c64*tanh(x4) + c65*tanh(x5)];
  end




